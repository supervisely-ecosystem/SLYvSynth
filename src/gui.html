<div id="v-synth">
    <sly-card title="Input Project" subtitle="Original data remains unchanged, new project will be created">
        <sly-field title="" description="Input Data">
            <a slot="title" target="_blank"
               :href="`/projects/${data.projectId}/datasets`">{{ data.projectName }} ({{ data.projectItemsCount }}
                images)</a>
            <sly-icon slot="icon" :options="{ imageUrl: `${data.projectPreviewUrl}` }"/>
        </sly-field>
    </sly-card>
    <div class="fflex mt15" style="align-items: stretch">
        <sly-card title="Select Background">


            <sly-select-team-workspace
                    :team-id.sync="state.teamId"
                    :workspace-id.sync="state.workspaceId">
            </sly-select-team-workspace>
            <sly-select-project
                    :workspace-id="state.workspaceId"
                    :project-id.sync="state.bgProjectId">
            </sly-select-project>
            <el-checkbox class="mt15" v-model="state.allDatasets">All datasets</el-checkbox>
            <sly-select-dataset
                    v-show="!state.allDatasets"
                    :project-id="state.bgProjectId"
                    :datasets.sync="state.bgDatasets"
                    :options="{'multiple': true}">
            </sly-select-dataset>

        </sly-card>
    </div>

    <sly-style>
        #sliding-window .field-radio {
        margin-bottom: 5px;
        display: inline-flex;
        width: (200px);
        white-space: normal;
        }
    </sly-style>

    <div class="fflex mt15" style="align-items: stretch">
        <sly-card class="mr15"
                  title="Settings"
                  subtitle="Synth params"
                  style="min-width: 310px; max-width: 310px;">
            <div><b>Speed interval</b></div>

            <div class="block">
                <el-slider
                        v-model="state.speedInterval"
                        range
                        show-stops
                        :min="1"
                        :max="32">
                </el-slider>
            </div>

            <sly-field style="margin-top: 15px;" title="MovementLaw" description="Select movement law(-s)">

                <div class="fflex align-start">
                    <el-checkbox v-model="state.linearLaw" class="mt10 mr10"/>
                    <sly-field class="mt20" title="Linear"
                               description="Move objects by line">
                    </sly-field>
                </div>

                <div class="fflex align-start">
                    <el-checkbox v-model="state.randomLaw" class="mt10 mr10"/>
                    <sly-field class="mt20" title="Random Y"
                               description="Move objects randomly">
                    </sly-field>
                </div>

            </sly-field>


            <div><b>Visualization FPS</b></div>
            <el-input-number class="mt5" v-model="state.fps" :min="10" :max="60"></el-input-number>


        </sly-card>
        <sly-card title="Preview"
                  subtitle="Visualize sliding windows on random image as video"
                  style="width: 100%">
            <div slot="header">
                <el-button
                        type="primary"
                        @click="state.previewLoading = true; command('preview')"
                        :loading="state.previewLoading"
                        :disabled="data.resProjectId || data.started"
                >
                    <i class="zmdi zmdi-slideshow" style="margin-right: 5px"></i> Preview
                </el-button>
            </div>
            <video v-if="data.videoUrl" controls style="max-height: 650px; max-width: 100%;">
                <!--                <source src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">-->
                <source :src="data.videoUrl" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div v-if="!data.videoUrl && state.previewLoading === false">Press preview to watch demo video</div>
            <div v-if=""></div>

            <div class="fflex mt10" v-if="state.previewLoading === true" style="align-items: baseline;">
                <div class="mr10" style="width: 120px;">{{ data.progressPreviewMessage }}:</div>
                <el-progress :percentage="data.progressPreview" style="flex: 1"></el-progress>
                <div class="ml10" style="flex: none;">[{{ data.progressPreviewCurrent }}
                    / {{ data.progressPreviewTotal }}]
                </div>
            </div>
        </sly-card>
    </div>

    <sly-card class="mt15"
              title="Output Project"
              subtitle="Define result project name, press Run and monitor progress">
        <sly-field title="Result project name">
            <el-input v-model="state.resProjectName"></el-input>
            <el-button class="mt10" type="primary" :loading="data.started" :disabled="data.resProjectId"
                       @click="data.started = true; command('split')">
                Split
            </el-button>
        </sly-field>

        <div style="margin-top: 30px;">
            <sly-field class="mt15"
                       v-if="data.resProjectId && !data.started"
                       title="New project has been created"
                       description="Split configuration is saved in project info (metadata) as json">
                <sly-field title="" description="Project">
                    <a slot="title" target="_blank"
                       :href="`/projects/${data.resProjectId}/datasets`">{{ data.resProjectName }}</a>
                    <sly-icon slot="icon" :options="{ imageUrl: `${data.resProjectPreviewUrl}` }"/>
                </sly-field>
            </sly-field>
        </div>
        <div class="fflex mt10" v-if="data.started === true">
            <div class="mr10" style="width: 120px;">Split images:</div>
            <el-progress class="mt10" v-if="data.started === true" :percentage="data.progress"
                         style="flex: 1"></el-progress>
            <div class="ml10" style="flex: none;">[{{ data.progressCurrent }} / {{ data.progressTotal }}]
            </div>
        </div>
    </sly-card>
</div>